(function(b,a){typeof exports==="object"&&typeof module!=="undefined"?module.exports=a():typeof define==="function"&&define.amd?define(a):(b=b||self,b.Viewer=a())}(this,(function(){function z(bP){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){z=function(bQ){return typeof bQ}}else{z=function(bQ){return bQ&&typeof Symbol==="function"&&bQ.constructor===Symbol&&bQ!==Symbol.prototype?"symbol":typeof bQ}}return z(bP)}function aw(bP,bQ){if(!(bP instanceof bQ)){throw new TypeError("Cannot call a class as a function")}}function bA(bS,bQ){for(var bP=0;bP<bQ.length;bP++){var bR=bQ[bP];bR.enumerable=bR.enumerable||false;bR.configurable=true;if("value" in bR){bR.writable=true}Object.defineProperty(bS,bR.key,bR)}}function aZ(bR,bP,bQ){if(bP){bA(bR.prototype,bP)}if(bQ){bA(bR,bQ)}return bR}function bb(bR,bP,bQ){if(bP in bR){Object.defineProperty(bR,bP,{value:bQ,enumerable:true,configurable:true,writable:true})}else{bR[bP]=bQ}return bR}function bt(bQ,bR){var bS=Object.keys(bQ);if(Object.getOwnPropertySymbols){var bP=Object.getOwnPropertySymbols(bQ);if(bR){bP=bP.filter(function(bT){return Object.getOwnPropertyDescriptor(bQ,bT).enumerable})}bS.push.apply(bS,bP)}return bS}function bJ(bR){for(var bP=1;bP<arguments.length;bP++){var bQ=arguments[bP]!=null?arguments[bP]:{};if(bP%2){bt(Object(bQ),true).forEach(function(bS){bb(bR,bS,bQ[bS])})}else{if(Object.getOwnPropertyDescriptors){Object.defineProperties(bR,Object.getOwnPropertyDescriptors(bQ))}else{bt(Object(bQ)).forEach(function(bS){Object.defineProperty(bR,bS,Object.getOwnPropertyDescriptor(bQ,bS))})}}}return bR}var N={backdrop:true,button:true,navbar:true,title:true,toolbar:true,className:"",container:"body",filter:null,fullscreen:true,initialViewIndex:0,inline:false,interval:5000,keyboard:true,loading:true,loop:true,minWidth:200,minHeight:100,movable:true,rotatable:true,scalable:true,zoomable:true,zoomOnTouch:true,zoomOnWheel:true,slideOnTouch:true,toggleOnDblclick:true,tooltip:true,transition:true,zIndex:2015,zIndexInline:0,zoomRatio:0.1,minZoomRatio:0.01,maxZoomRatio:100,url:"src",ready:null,show:null,shown:null,hide:null,hidden:null,view:null,viewed:null,zoom:null,zoomed:null};var ae='<div class="viewer-container" touch-action="none">'+'<div class="viewer-canvas"></div>'+'<div class="viewer-footer">'+'<div class="viewer-title"></div>'+'<div class="viewer-toolbar"></div>'+'<div class="viewer-navbar">'+'<ul class="viewer-list"></ul>'+"</div>"+"</div>"+'<div class="viewer-tooltip"></div>'+'<div role="button" class="viewer-button" data-viewer-action="mix"></div>'+'<div class="viewer-player"></div>'+"</div>";var d=typeof window!=="undefined"&&typeof window.document!=="undefined";var an=d?window:{};var H=d?"ontouchstart" in an.document.documentElement:false;var bo=d?"PointerEvent" in an:false;var G="viewer";var bx="move";var aj="switch";var y="zoom";var ay="".concat(G,"-active");var bB="".concat(G,"-close");var c="".concat(G,"-fade");var bI="".concat(G,"-fixed");var bu="".concat(G,"-fullscreen");var bn="".concat(G,"-fullscreen-exit");var ac="".concat(G,"-hide");var bH="".concat(G,"-hide-md-down");var h="".concat(G,"-hide-sm-down");var aB="".concat(G,"-hide-xs-down");var J="".concat(G,"-in");var ab="".concat(G,"-invisible");var bi="".concat(G,"-loading");var bN="".concat(G,"-move");var A="".concat(G,"-open");var T="".concat(G,"-show");var bp="".concat(G,"-transition");var s="click";var bC="dblclick";var I="dragstart";var a9="hidden";var at="hide";var a="keydown";var aC="load";var be=H?"touchstart":"mousedown";var ba=H?"touchmove":"mousemove";var C=H?"touchend touchcancel":"mouseup";var bl=bo?"pointerdown":be;var br=bo?"pointermove":ba;var bD=bo?"pointerup pointercancel":C;var ad="ready";var ar="resize";var ai="show";var k="shown";var aQ="transitionend";var Z="view";var bE="viewed";var aF="wheel";var af="zoom";var az="zoomed";var bg="".concat(G,"Action");var B=/\s\s*/;var n=["zoom-in","zoom-out","one-to-one","reset","prev","play","next","rotate-left","rotate-right","flip-horizontal","flip-vertical"];function bf(bP){return typeof bP==="string"}var aA=Number.isNaN||an.isNaN;function V(bP){return typeof bP==="number"&&!aA(bP)}function aJ(bP){return typeof bP==="undefined"}function bL(bP){return z(bP)==="object"&&bP!==null}var D=Object.prototype.hasOwnProperty;function o(bR){if(!bL(bR)){return false}try{var bS=bR.constructor;var bQ=bS.prototype;return bS&&bQ&&D.call(bQ,"isPrototypeOf")}catch(bP){return false}}function j(bP){return typeof bP==="function"}function ag(bR,bS){if(bR&&j(bS)){if(Array.isArray(bR)||V(bR.length)){var bQ=bR.length;var bP;for(bP=0;bP<bQ;bP+=1){if(bS.call(bR,bR[bP],bP,bR)===false){break}}}else{if(bL(bR)){Object.keys(bR).forEach(function(bT){bS.call(bR,bR[bT],bT,bR)})}}}return bR}var W=Object.assign||function W(bS){for(var bP=arguments.length,bQ=new Array(bP>1?bP-1:0),bR=1;
bR<bP;bR++){bQ[bR-1]=arguments[bR]}if(bL(bS)&&bQ.length>0){bQ.forEach(function(bT){if(bL(bT)){Object.keys(bT).forEach(function(bU){bS[bU]=bT[bU]})}})}return bS};var e=/^(?:width|height|left|top|marginLeft|marginTop)$/;function M(bP,bR){var bQ=bP.style;ag(bR,function(bT,bS){if(e.test(bS)&&V(bT)){bT+="px"}bQ[bS]=bT})}function K(bP){return bf(bP)?bP.replace(/&(?!amp;|quot;|#39;|lt;|gt;)/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):bP}function r(bP,bQ){if(!bP||!bQ){return false}return bP.classList?bP.classList.contains(bQ):bP.className.indexOf(bQ)>-1}function q(bP,bR){if(!bP||!bR){return}if(V(bP.length)){ag(bP,function(bS){q(bS,bR)});return}if(bP.classList){bP.classList.add(bR);return}var bQ=bP.className.trim();if(!bQ){bP.className=bR}else{if(bQ.indexOf(bR)<0){bP.className="".concat(bQ," ").concat(bR)}}}function aU(bP,bQ){if(!bP||!bQ){return}if(V(bP.length)){ag(bP,function(bR){aU(bR,bQ)});return}if(bP.classList){bP.classList.remove(bQ);return}if(bP.className.indexOf(bQ)>=0){bP.className=bP.className.replace(bQ,"")}}function aS(bP,bR,bQ){if(!bR){return}if(V(bP.length)){ag(bP,function(bS){aS(bS,bR,bQ)});return}if(bQ){q(bP,bR)}else{aU(bP,bR)}}var a0=/([a-z\d])([A-Z])/g;function bs(bP){return bP.replace(a0,"$1-$2").toLowerCase()}function a5(bQ,bP){if(bL(bQ[bP])){return bQ[bP]}if(bQ.dataset){return bQ.dataset[bP]}return bQ.getAttribute("data-".concat(bs(bP)))}function ak(bQ,bP,bR){if(bL(bR)){bQ[bP]=bR}else{if(bQ.dataset){bQ.dataset[bP]=bR}else{bQ.setAttribute("data-".concat(bs(bP)),bR)}}}var aE=function(){var bP=false;if(d){var bS=false;var bT=function bT(){};var bR=Object.defineProperty({},"once",{get:function bQ(){bP=true;return bS},set:function bU(bV){bS=bV}});an.addEventListener("test",bT,bR);an.removeEventListener("test",bT,bR)}return bP}();function f(bQ,bS,bT){var bP=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var bR=bT;bS.trim().split(B).forEach(function(bV){if(!aE){var bU=bQ.listeners;if(bU&&bU[bV]&&bU[bV][bT]){bR=bU[bV][bT];delete bU[bV][bT];if(Object.keys(bU[bV]).length===0){delete bU[bV]}if(Object.keys(bU).length===0){delete bQ.listeners}}}bQ.removeEventListener(bV,bR,bP)})}function bk(bR,bS,bT){var bQ=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var bP=bT;bS.trim().split(B).forEach(function(bX){if(bQ.once&&!aE){var bU=bR.listeners,bW=bU===void 0?{}:bU;bP=function bV(){delete bW[bX][bT];bR.removeEventListener(bX,bP,bQ);for(var bY=arguments.length,b0=new Array(bY),bZ=0;bZ<bY;bZ++){b0[bZ]=arguments[bZ]}bT.apply(bR,b0)};if(!bW[bX]){bW[bX]={}}if(bW[bX][bT]){bR.removeEventListener(bX,bW[bX][bT],bQ)}bW[bX][bT]=bP;bR.listeners=bW}bR.addEventListener(bX,bP,bQ)})}function aL(bP,bQ,bS){var bR;if(j(Event)&&j(CustomEvent)){bR=new CustomEvent(bQ,{detail:bS,bubbles:true,cancelable:true})}else{bR=document.createEvent("CustomEvent");bR.initCustomEvent(bQ,true,true,bS)}return bP.dispatchEvent(bR)}function bK(bP){var bQ=bP.getBoundingClientRect();return{left:bQ.left+(window.pageXOffset-document.documentElement.clientLeft),top:bQ.top+(window.pageYOffset-document.documentElement.clientTop)}}function E(bU){var bT=bU.rotate,bS=bU.scaleX,bQ=bU.scaleY,bW=bU.translateX,bV=bU.translateY;var bP=[];if(V(bW)&&bW!==0){bP.push("translateX(".concat(bW,"px)"))}if(V(bV)&&bV!==0){bP.push("translateY(".concat(bV,"px)"))}if(V(bT)&&bT!==0){bP.push("rotate(".concat(bT,"deg)"))}if(V(bS)&&bS!==1){bP.push("scaleX(".concat(bS,")"))}if(V(bQ)&&bQ!==1){bP.push("scaleY(".concat(bQ,")"))}var bR=bP.length?bP.join(" "):"none";return{WebkitTransform:bR,msTransform:bR,transform:bR}}function bG(bP){return bf(bP)?decodeURIComponent(bP.replace(/^.*\//,"").replace(/[?&#].*$/,"")):""}var bz=an.navigator&&/(Macintosh|iPhone|iPod|iPad).*AppleWebKit/i.test(an.navigator.userAgent);function aX(bQ,bS){var bR=document.createElement("img");if(bQ.naturalWidth&&!bz){bS(bQ.naturalWidth,bQ.naturalHeight);return bR}var bP=document.body||document.documentElement;bR.onload=function(){bS(bR.width,bR.height);if(!bz){bP.removeChild(bR)}};bR.src=bQ.src;if(!bz){bR.style.cssText="left:0;"+"max-height:none!important;"+"max-width:none!important;"+"min-height:0!important;"+"min-width:0!important;"+"opacity:0;"+"position:absolute;"+"top:0;"+"z-index:-1;";bP.appendChild(bR)}return bR}function R(bP){switch(bP){case 2:return aB;case 3:return h;case 4:return bH;default:return""}}function a4(bP){var bR=bJ({},bP);var bQ=[];ag(bP,function(bT,bS){delete bR[bS];ag(bR,function(bU){var bW=Math.abs(bT.startX-bU.startX);var bZ=Math.abs(bT.startY-bU.startY);var bV=Math.abs(bT.endX-bU.endX);var bX=Math.abs(bT.endY-bU.endY);var b1=Math.sqrt(bW*bW+bZ*bZ);var b0=Math.sqrt(bV*bV+bX*bX);var bY=(b0-b1)/b1;bQ.push(bY)})});bQ.sort(function(bT,bS){return Math.abs(bT)<Math.abs(bS)});return bQ[0]}function au(bT,bS){var bR=bT.pageX,bQ=bT.pageY;var bP={endX:bR,endY:bQ};return bS?bP:bJ({timeStamp:Date.now(),startX:bR,startY:bQ},bP)}function bj(bP){var bR=0;var bQ=0;var bS=0;ag(bP,function(bV){var bU=bV.startX,bT=bV.startY;bR+=bU;bQ+=bT;
bS+=1});bR/=bS;bQ/=bS;return{pageX:bR,pageY:bQ}}var Q={render:function Q(){this.initContainer();this.initViewer();this.initList();this.renderViewer()},initContainer:function bh(){this.containerData={width:window.innerWidth,height:window.innerHeight}},initViewer:function aH(){var bP=this.options,bQ=this.parent;var bR;if(bP.inline){bR={width:Math.max(bQ.offsetWidth,bP.minWidth),height:Math.max(bQ.offsetHeight,bP.minHeight)};this.parentData=bR}if(this.fulled||!bR){bR=this.containerData}this.viewerData=W({},bR)},renderViewer:function a7(){if(this.options.inline&&!this.fulled){M(this.viewer,this.viewerData)}},initList:function bm(){var bT=this;var bR=this.element,bQ=this.options,bS=this.list;var bP=[];bS.innerHTML="";ag(this.images,function(bZ,bW){var b0=bZ.src;var bY=bZ.alt||bG(b0);var bV=bQ.url;if(bf(bV)){bV=bZ.getAttribute(bV)}else{if(j(bV)){bV=bV.call(bT,bZ)}}if(b0||bV){var bX=document.createElement("li");var bU=document.createElement("img");bU.src=b0||bV;bU.alt=bY;bU.setAttribute("data-index",bW);bU.setAttribute("data-original-url",bV||b0);bU.setAttribute("data-viewer-action","view");bU.setAttribute("role","button");bX.appendChild(bU);bS.appendChild(bX);bP.push(bX)}});this.items=bP;ag(bP,function(bU){var bV=bU.firstElementChild;ak(bV,"filled",true);if(bQ.loading){q(bU,bi)}bk(bV,aC,function(bW){if(bQ.loading){aU(bU,bi)}bT.loadImage(bW)},{once:true})});if(bQ.transition){bk(bR,bE,function(){q(bS,bp)},{once:true})}},renderList:function L(bP){var bQ=bP||this.index;var bR=this.items[bQ].offsetWidth||30;var bS=bR+1;M(this.list,W({width:bS*this.length},E({translateX:(this.viewerData.width-bR)/2-bS*bQ})))},resetList:function aY(){var bP=this.list;bP.innerHTML="";aU(bP,bp);M(bP,E({translateX:0}))},initImage:function by(bU){var bX=this;var bZ=this.options,bT=this.image,bP=this.viewerData;var bY=this.footer.offsetHeight;var bR=bP.width;var bW=Math.max(bP.height-bY,bY);var bQ=this.imageData||{};var bS;this.imageInitializing={abort:function bV(){bS.onload=null}};bS=aX(bT,function(b2,b5){var b4=b2/b5;var b3=bR;var b1=bW;bX.imageInitializing=false;if(bW*b4>bR){b1=bR/b4}else{b3=bW*b4}b3=Math.min(b3*0.9,b2);b1=Math.min(b1*0.9,b5);var b6={naturalWidth:b2,naturalHeight:b5,aspectRatio:b4,ratio:b3/b2,width:b3,height:b1,left:(bR-b3)/2,top:(bW-b1)/2};var b0=W({},b6);if(bZ.rotatable){b6.rotate=bQ.rotate||0;b0.rotate=0}if(bZ.scalable){b6.scaleX=bQ.scaleX||1;b6.scaleY=bQ.scaleY||1;b0.scaleX=1;b0.scaleY=1}bX.imageData=b6;bX.initialImageData=b0;if(bU){bU()}})},renderImage:function bw(bP){var bR=this;var bS=this.image,bU=this.imageData;M(bS,W({width:bU.width,height:bU.height,marginLeft:bU.left,marginTop:bU.top},E(bU)));if(bP){if((this.viewing||this.zooming)&&this.options.transition){var bQ=function bQ(){bR.imageRendering=false;bP()};this.imageRendering={abort:function bT(){f(bS,aQ,bQ)}};bk(bS,aQ,bQ,{once:true})}else{bP()}}},resetImage:function ah(){if(this.viewing||this.viewed){var bP=this.image;if(this.viewing){this.viewing.abort()}bP.parentNode.removeChild(bP);this.image=null}}};var bF={bind:function aK(){var bR=this.options,bS=this.viewer,bQ=this.canvas;var bP=this.element.ownerDocument;bk(bS,s,this.onClick=this.click.bind(this));bk(bS,I,this.onDragStart=this.dragstart.bind(this));bk(bQ,bl,this.onPointerDown=this.pointerdown.bind(this));bk(bP,br,this.onPointerMove=this.pointermove.bind(this));bk(bP,bD,this.onPointerUp=this.pointerup.bind(this));bk(bP,a,this.onKeyDown=this.keydown.bind(this));bk(window,ar,this.onResize=this.resize.bind(this));if(bR.zoomable&&bR.zoomOnWheel){bk(bS,aF,this.onWheel=this.wheel.bind(this),{passive:false,capture:true})}if(bR.toggleOnDblclick){bk(bQ,bC,this.onDblclick=this.dblclick.bind(this))}},unbind:function bc(){var bR=this.options,bS=this.viewer,bQ=this.canvas;var bP=this.element.ownerDocument;f(bS,s,this.onClick);f(bS,I,this.onDragStart);f(bQ,bl,this.onPointerDown);f(bP,br,this.onPointerMove);f(bP,bD,this.onPointerUp);f(bP,a,this.onKeyDown);f(window,ar,this.onResize);if(bR.zoomable&&bR.zoomOnWheel){f(bS,aF,this.onWheel,{passive:false,capture:true})}if(bR.toggleOnDblclick){f(bQ,bC,this.onDblclick)}}};var aT={click:function a3(bQ){var bS=bQ.target;var bP=this.options,bT=this.imageData;var bR=a5(bS,bg);if(H&&bQ.isTrusted&&bS===this.canvas){clearTimeout(this.clickCanvasTimeout)}switch(bR){case"mix":if(this.played){this.stop()}else{if(bP.inline){if(this.fulled){this.exit()}else{this.full()}}else{this.hide()}}break;case"hide":this.hide();break;case"view":this.view(a5(bS,"index"));break;case"zoom-in":this.zoom(0.1,true);break;case"zoom-out":this.zoom(-0.1,true);break;case"one-to-one":this.toggle();break;case"reset":this.reset();break;case"prev":this.prev(bP.loop);break;case"play":this.play(bP.fullscreen);break;case"next":this.next(bP.loop);break;case"rotate-left":this.rotate(-90);break;case"rotate-right":this.rotate(90);break;case"flip-horizontal":this.scaleX(-bT.scaleX||-1);break;case"flip-vertical":this.scaleY(-bT.scaleY||-1);break;default:if(this.played){this.stop()}}},dblclick:function aa(bP){bP.preventDefault();
if(this.viewed&&bP.target===this.image){if(H&&bP.isTrusted){clearTimeout(this.doubleClickImageTimeout)}this.toggle()}},load:function bd(){var bU=this;if(this.timeout){clearTimeout(this.timeout);this.timeout=false}var bR=this.element,bQ=this.options,bS=this.image,bP=this.index,bT=this.viewerData;aU(bS,ab);if(bQ.loading){aU(this.canvas,bi)}bS.style.cssText="height:0;"+"margin-left:".concat(bT.width/2,"px;")+"margin-top:".concat(bT.height/2,"px;")+"max-width:none!important;"+"position:absolute;"+"width:0;";this.initImage(function(){aS(bS,bN,bQ.movable);aS(bS,bp,bQ.transition);bU.renderImage(function(){bU.viewed=true;bU.viewing=false;if(j(bQ.viewed)){bk(bR,bE,bQ.viewed,{once:true})}aL(bR,bE,{originalImage:bU.images[bP],index:bP,image:bS})})})},loadImage:function u(bS){var bU=bS.target;var bR=bU.parentNode;var bQ=bR.offsetWidth||30;var bP=bR.offsetHeight||50;var bT=!!a5(bU,"filled");aX(bU,function(bW,bZ){var bY=bW/bZ;var bX=bQ;var bV=bP;if(bP*bY>bQ){if(bT){bX=bP*bY}else{bV=bQ/bY}}else{if(bT){bV=bQ/bY}else{bX=bP*bY}}M(bU,W({width:bX,height:bV},E({translateX:(bQ-bX)/2,translateY:(bP-bV)/2})))})},keydown:function a6(bQ){var bP=this.options;if(!this.fulled||!bP.keyboard){return}switch(bQ.keyCode||bQ.which||bQ.charCode){case 27:if(this.played){this.stop()}else{if(bP.inline){if(this.fulled){this.exit()}}else{this.hide()}}break;case 32:if(this.played){this.stop()}break;case 37:this.prev(bP.loop);break;case 38:bQ.preventDefault();this.zoom(bP.zoomRatio,true);break;case 39:this.next(bP.loop);break;case 40:bQ.preventDefault();this.zoom(-bP.zoomRatio,true);break;case 48:case 49:if(bQ.ctrlKey){bQ.preventDefault();this.toggle()}break}},dragstart:function b(bP){if(bP.target.tagName.toLowerCase()==="img"){bP.preventDefault()}},pointerdown:function al(bT){var bQ=this.options,bP=this.pointers;var bS=bT.buttons,bR=bT.button;if(!this.viewed||this.showing||this.viewing||this.hiding||(bT.type==="mousedown"||bT.type==="pointerdown"&&bT.pointerType==="mouse")&&(V(bS)&&bS!==1||V(bR)&&bR!==0||bT.ctrlKey)){return}bT.preventDefault();if(bT.changedTouches){ag(bT.changedTouches,function(bV){bP[bV.identifier]=au(bV)})}else{bP[bT.pointerId||0]=au(bT)}var bU=bQ.movable?bx:false;if(bQ.zoomOnTouch&&bQ.zoomable&&Object.keys(bP).length>1){bU=y}else{if(bQ.slideOnTouch&&(bT.pointerType==="touch"||bT.type==="touchstart")&&this.isSwitchable()){bU=aj}}if(bQ.transition&&(bU===bx||bU===y)){aU(this.image,bp)}this.action=bU},pointermove:function ax(bQ){var bP=this.pointers,bR=this.action;if(!this.viewed||!bR){return}bQ.preventDefault();if(bQ.changedTouches){ag(bQ.changedTouches,function(bS){W(bP[bS.identifier]||{},au(bS,true))})}else{W(bP[bQ.pointerId||0]||{},au(bQ,true))}this.change(bQ)},pointerup:function x(bS){var bR=this;var bQ=this.options,bT=this.action,bP=this.pointers;var bU;if(bS.changedTouches){ag(bS.changedTouches,function(bV){bU=bP[bV.identifier];delete bP[bV.identifier]})}else{bU=bP[bS.pointerId||0];delete bP[bS.pointerId||0]}if(!bT){return}bS.preventDefault();if(bQ.transition&&(bT===bx||bT===y)){q(this.image,bp)}this.action=false;if(H&&bT!==y&&bU&&Date.now()-bU.timeStamp<500){clearTimeout(this.clickCanvasTimeout);clearTimeout(this.doubleClickImageTimeout);if(bQ.toggleOnDblclick&&this.viewed&&bS.target===this.image){if(this.imageClicked){this.imageClicked=false;this.doubleClickImageTimeout=setTimeout(function(){aL(bR.image,bC)},50)}else{this.imageClicked=true;this.doubleClickImageTimeout=setTimeout(function(){bR.imageClicked=false},500)}}else{this.imageClicked=false;if(bQ.backdrop&&bQ.backdrop!=="static"&&bS.target===this.canvas){this.clickCanvasTimeout=setTimeout(function(){aL(bR.canvas,s)},50)}}}},resize:function v(){var bP=this;if(!this.isShown||this.hiding){return}this.initContainer();this.initViewer();this.renderViewer();this.renderList();if(this.viewed){this.initImage(function(){bP.renderImage()})}if(this.played){if(this.options.fullscreen&&this.fulled&&!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)){this.stop();return}ag(this.player.getElementsByTagName("img"),function(bQ){bk(bQ,aC,bP.loadImage.bind(bP),{once:true});aL(bQ,aC)})}},wheel:function g(bR){var bP=this;if(!this.viewed){return}bR.preventDefault();if(this.wheeling){return}this.wheeling=true;setTimeout(function(){bP.wheeling=false},50);var bQ=Number(this.options.zoomRatio)||0.1;var bS=1;if(bR.deltaY){bS=bR.deltaY>0?1:-1}else{if(bR.wheelDelta){bS=-bR.wheelDelta/120}else{if(bR.detail){bS=bR.detail>0?1:-1}}}this.zoom(-bS*bQ,true,bR)}};var aq={show:function aW(){var bP=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var bR=this.element,bQ=this.options;if(bQ.inline||this.showing||this.isShown||this.showing){return this}if(!this.ready){this.build();if(this.ready){this.show(bP)}return this}if(j(bQ.show)){bk(bR,ai,bQ.show,{once:true})}if(aL(bR,ai)===false||!this.ready){return this}if(this.hiding){this.transitioning.abort()}this.showing=true;this.open();var bT=this.viewer;aU(bT,ac);if(bQ.transition&&!bP){var bS=this.shown.bind(this);
this.transitioning={abort:function bU(){f(bT,aQ,bS);aU(bT,J)}};q(bT,bp);bT.initialOffsetWidth=bT.offsetWidth;bk(bT,aQ,bS,{once:true});q(bT,J)}else{q(bT,J);this.shown()}return this},hide:function a2(){var bP=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var bS=this.element,bQ=this.options;if(bQ.inline||this.hiding||!(this.isShown||this.showing)){return this}if(j(bQ.hide)){bk(bS,at,bQ.hide,{once:true})}if(aL(bS,at)===false){return this}if(this.showing){this.transitioning.abort()}this.hiding=true;if(this.played){this.stop()}else{if(this.viewing){this.viewing.abort()}}var bU=this.viewer;if(bQ.transition&&!bP){var bT=this.hidden.bind(this);var bR=function bR(){setTimeout(function(){bk(bU,aQ,bT,{once:true});aU(bU,J)},0)};this.transitioning={abort:function bV(){if(this.viewed){f(this.image,aQ,bR)}else{f(bU,aQ,bT)}}};if(this.viewed&&r(this.image,bp)){bk(this.image,aQ,bR,{once:true});this.zoomTo(0,false,false,true)}else{bR()}}else{aU(bU,J);this.hidden()}return this},view:function aN(){var bW=this;var bX=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.options.initialViewIndex;bX=Number(bX)||0;if(this.hiding||this.played||bX<0||bX>=this.length||this.viewed&&bX===this.index){return this}if(!this.isShown){this.index=bX;return this.show()}if(this.viewing){this.viewing.abort()}var bT=this.element,b2=this.options,bZ=this.title,bQ=this.canvas;var b1=this.items[bX];var bU=b1.querySelector("img");var bP=a5(bU,"originalUrl");var bV=bU.getAttribute("alt");var bR=document.createElement("img");bR.src=bP;bR.alt=bV;if(j(b2.view)){bk(bT,Z,b2.view,{once:true})}if(aL(bT,Z,{originalImage:this.images[bX],index:bX,image:bR})===false||!this.isShown||this.hiding||this.played){return this}this.image=bR;aU(this.items[this.index],ay);q(b1,ay);this.viewed=false;this.index=bX;this.imageData={};q(bR,ab);if(b2.loading){q(bQ,bi)}bQ.innerHTML="";bQ.appendChild(bR);this.renderList();bZ.innerHTML="";var b0=function b0(){var b4=bW.imageData;var b3=Array.isArray(b2.title)?b2.title[1]:b2.title;bZ.innerHTML=K(j(b3)?b3.call(bW,bR,b4):"".concat(bV," (").concat(b4.naturalWidth," \xD7 ").concat(b4.naturalHeight,")"))};var bY;bk(bT,bE,b0,{once:true});this.viewing={abort:function bS(){f(bT,bE,b0);if(bR.complete){if(this.imageRendering){this.imageRendering.abort()}else{if(this.imageInitializing){this.imageInitializing.abort()}}}else{bR.src="";f(bR,aC,bY);if(this.timeout){clearTimeout(this.timeout)}}}};if(bR.complete){this.load()}else{bk(bR,aC,bY=this.load.bind(this),{once:true});if(this.timeout){clearTimeout(this.timeout)}this.timeout=setTimeout(function(){aU(bR,ab);bW.timeout=false},1000)}return this},prev:function a8(){var bP=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var bQ=this.index-1;if(bQ<0){bQ=bP?this.length-1:0}this.view(bQ);return this},next:function X(){var bP=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;var bR=this.length-1;var bQ=this.index+1;if(bQ>bR){bQ=bP?0:bR}this.view(bQ);return this},move:function F(bP,bR){var bQ=this.imageData;this.moveTo(aJ(bP)?bP:bQ.left+Number(bP),aJ(bR)?bR:bQ.top+Number(bR));return this},moveTo:function bq(bP){var bS=arguments.length>1&&arguments[1]!==undefined?arguments[1]:bP;var bR=this.imageData;bP=Number(bP);bS=Number(bS);if(this.viewed&&!this.played&&this.options.movable){var bQ=false;if(V(bP)){bR.left=bP;bQ=true}if(V(bS)){bR.top=bS;bQ=true}if(bQ){this.renderImage()}}return this},zoom:function aR(bR){var bQ=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var bP=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var bS=this.imageData;bR=Number(bR);if(bR<0){bR=1/(1-bR)}else{bR=1+bR}this.zoomTo(bS.width*bR/bS.naturalWidth,bQ,bP);return this},zoomTo:function aM(bY){var ca=this;var b0=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;var b7=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;var b5=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;var bQ=this.element,bU=this.options,b2=this.pointers,cb=this.imageData;var b8=cb.width,b4=cb.height,bV=cb.left,b3=cb.top,bS=cb.naturalWidth,bR=cb.naturalHeight;bY=Math.max(0,bY);if(V(bY)&&this.viewed&&!this.played&&(b5||bU.zoomable)){if(!b5){var bZ=Math.max(0.01,bU.minZoomRatio);var bP=Math.min(100,bU.maxZoomRatio);bY=Math.min(Math.max(bY,bZ),bP)}if(b7&&bY>0.95&&bY<1.05){bY=1}var b1=bS*bY;var b9=bR*bY;var b6=b1-b8;var bT=b9-b4;var bW=b8/bS;if(j(bU.zoom)){bk(bQ,af,bU.zoom,{once:true})}if(aL(bQ,af,{ratio:bY,oldRatio:bW,originalEvent:b7})===false){return this}this.zooming=true;if(b7){var bX=bK(this.viewer);var cc=b2&&Object.keys(b2).length?bj(b2):{pageX:b7.pageX,pageY:b7.pageY};cb.left-=b6*((cc.pageX-bX.left-bV)/b8);cb.top-=bT*((cc.pageY-bX.top-b3)/b4)}else{cb.left-=b6/2;cb.top-=bT/2}cb.width=b1;cb.height=b9;cb.ratio=bY;this.renderImage(function(){ca.zooming=false;if(j(bU.zoomed)){bk(bQ,az,bU.zoomed,{once:true})}aL(bQ,az,{ratio:bY,oldRatio:bW,originalEvent:b7})});if(b0){this.tooltip()}}return this},rotate:function m(bP){this.rotateTo((this.imageData.rotate||0)+Number(bP));
return this},rotateTo:function bO(bP){var bQ=this.imageData;bP=Number(bP);if(V(bP)&&this.viewed&&!this.played&&this.options.rotatable){bQ.rotate=bP;this.renderImage()}return this},scaleX:function P(bP){this.scale(bP,this.imageData.scaleY);return this},scaleY:function O(bP){this.scale(this.imageData.scaleX,bP);return this},scale:function aO(bQ){var bP=arguments.length>1&&arguments[1]!==undefined?arguments[1]:bQ;var bS=this.imageData;bQ=Number(bQ);bP=Number(bP);if(this.viewed&&!this.played&&this.options.scalable){var bR=false;if(V(bQ)){bS.scaleX=bQ;bR=true}if(V(bP)){bS.scaleY=bP;bR=true}if(bR){this.renderImage()}}return this},play:function i(){var bQ=this;var bV=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(!this.isShown||this.played){return this}var bX=this.options,bW=this.player;var bT=this.loadImage.bind(this);var bS=[];var bU=0;var bR=0;this.played=true;this.onLoadWhenPlay=bT;if(bV){this.requestFullscreen()}q(bW,T);ag(this.items,function(b0,bZ){var bY=b0.querySelector("img");var b1=document.createElement("img");b1.src=a5(bY,"originalUrl");b1.alt=bY.getAttribute("alt");bU+=1;q(b1,c);aS(b1,bp,bX.transition);if(r(b0,ay)){q(b1,J);bR=bZ}bS.push(b1);bk(b1,aC,bT,{once:true});bW.appendChild(b1)});if(V(bX.interval)&&bX.interval>0){var bP=function bP(){bQ.playing=setTimeout(function(){aU(bS[bR],J);bR+=1;bR=bR<bU?bR:0;q(bS[bR],J);bP()},bX.interval)};if(bU>1){bP()}}return this},stop:function aG(){var bQ=this;if(!this.played){return this}var bP=this.player;this.played=false;clearTimeout(this.playing);ag(bP.getElementsByTagName("img"),function(bR){f(bR,aC,bQ.onLoadWhenPlay)});aU(bP,T);bP.innerHTML="";this.exitFullscreen();return this},full:function av(){var bQ=this;var bP=this.options,bT=this.viewer,bS=this.image,bR=this.list;if(!this.isShown||this.played||this.fulled||!bP.inline){return this}this.fulled=true;this.open();q(this.button,bn);if(bP.transition){aU(bR,bp);if(this.viewed){aU(bS,bp)}}q(bT,bI);bT.setAttribute("style","");M(bT,{zIndex:bP.zIndex});this.initContainer();this.viewerData=W({},this.containerData);this.renderList();if(this.viewed){this.initImage(function(){bQ.renderImage(function(){if(bP.transition){setTimeout(function(){q(bS,bp);q(bR,bp)},0)}})})}return this},exit:function bM(){var bP=this;var bQ=this.options,bT=this.viewer,bS=this.image,bR=this.list;if(!this.isShown||this.played||!this.fulled||!bQ.inline){return this}this.fulled=false;this.close();aU(this.button,bn);if(bQ.transition){aU(bR,bp);if(this.viewed){aU(bS,bp)}}aU(bT,bI);M(bT,{zIndex:bQ.zIndexInline});this.viewerData=W({},this.parentData);this.renderViewer();this.renderList();if(this.viewed){this.initImage(function(){bP.renderImage(function(){if(bQ.transition){setTimeout(function(){q(bS,bp);q(bR,bp)},0)}})})}return this},tooltip:function w(){var bP=this;var bR=this.options,bQ=this.tooltipBox,bS=this.imageData;if(!this.viewed||this.played||!bR.tooltip){return this}bQ.textContent="".concat(Math.round(bS.ratio*100),"%");if(!this.tooltipping){if(bR.transition){if(this.fading){aL(bQ,aQ)}q(bQ,T);q(bQ,c);q(bQ,bp);bQ.initialOffsetWidth=bQ.offsetWidth;q(bQ,J)}else{q(bQ,T)}}else{clearTimeout(this.tooltipping)}this.tooltipping=setTimeout(function(){if(bR.transition){bk(bQ,aQ,function(){aU(bQ,T);aU(bQ,c);aU(bQ,bp);bP.fading=false},{once:true});aU(bQ,J);bP.fading=true}else{aU(bQ,T)}bP.tooltipping=false},1000);return this},toggle:function am(){if(this.imageData.ratio===1){this.zoomTo(this.initialImageData.ratio,true)}else{this.zoomTo(1,true)}return this},reset:function a1(){if(this.viewed&&!this.played){this.imageData=W({},this.initialImageData);this.renderImage()}return this},update:function p(){var bT=this.element,bS=this.options,bU=this.isImg;if(bU&&!bT.parentNode){return this.destroy()}var bP=[];ag(bU?[bT]:bT.querySelectorAll("img"),function(bV){if(bS.filter){if(bS.filter(bV)){bP.push(bV)}}else{bP.push(bV)}});if(!bP.length){return this}this.images=bP;this.length=bP.length;if(this.ready){var bR=[];ag(this.items,function(bX,bW){var bV=bX.querySelector("img");var bY=bP[bW];if(bY&&bV){if(bY.src!==bV.src){bR.push(bW)}}else{bR.push(bW)}});M(this.list,{width:"auto"});this.initList();if(this.isShown){if(this.length){if(this.viewed){var bQ=bR.indexOf(this.index);if(bQ>=0){this.viewed=false;this.view(Math.max(this.index-(bQ+1),0))}else{q(this.items[this.index],ay)}}}else{this.image=null;this.viewed=false;this.index=0;this.imageData={};this.canvas.innerHTML="";this.title.innerHTML=""}}}else{this.build()}return this},destroy:function l(){var bQ=this.element,bP=this.options;if(!bQ[G]){return this}this.destroyed=true;if(this.ready){if(this.played){this.stop()}if(bP.inline){if(this.fulled){this.exit()}this.unbind()}else{if(this.isShown){if(this.viewing){if(this.imageRendering){this.imageRendering.abort()}else{if(this.imageInitializing){this.imageInitializing.abort()}}}if(this.hiding){this.transitioning.abort()}this.hidden()}else{if(this.showing){this.transitioning.abort();this.hidden()}}}this.ready=false;this.viewer.parentNode.removeChild(this.viewer)
}else{if(bP.inline){if(this.delaying){this.delaying.abort()}else{if(this.initializing){this.initializing.abort()}}}}if(!bP.inline){f(bQ,s,this.onStart)}bQ[G]=undefined;return this}};var ap={open:function aD(){var bP=this.body;q(bP,A);bP.style.paddingRight="".concat(this.scrollbarWidth+(parseFloat(this.initialBodyPaddingRight)||0),"px")},close:function Y(){var bP=this.body;aU(bP,A);bP.style.paddingRight=this.initialBodyPaddingRight},shown:function aV(){var bQ=this.element,bP=this.options;this.fulled=true;this.isShown=true;this.render();this.bind();this.showing=false;if(j(bP.shown)){bk(bQ,k,bP.shown,{once:true})}if(aL(bQ,k)===false){return}if(this.ready&&this.isShown&&!this.hiding){this.view(this.index)}},hidden:function ao(){var bQ=this.element,bP=this.options;this.fulled=false;this.viewed=false;this.isShown=false;this.close();this.unbind();q(this.viewer,ac);this.resetList();this.resetImage();this.hiding=false;if(!this.destroyed){if(j(bP.hidden)){bk(bQ,a9,bP.hidden,{once:true})}aL(bQ,a9)}},requestFullscreen:function U(){var bP=this.element.ownerDocument;if(this.fulled&&!(bP.fullscreenElement||bP.webkitFullscreenElement||bP.mozFullScreenElement||bP.msFullscreenElement)){var bQ=bP.documentElement;if(bQ.requestFullscreen){bQ.requestFullscreen()}else{if(bQ.webkitRequestFullscreen){bQ.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}else{if(bQ.mozRequestFullScreen){bQ.mozRequestFullScreen()}else{if(bQ.msRequestFullscreen){bQ.msRequestFullscreen()}}}}}},exitFullscreen:function t(){var bP=this.element.ownerDocument;if(this.fulled&&(bP.fullscreenElement||bP.webkitFullscreenElement||bP.mozFullScreenElement||bP.msFullscreenElement)){if(bP.exitFullscreen){bP.exitFullscreen()}else{if(bP.webkitExitFullscreen){bP.webkitExitFullscreen()}else{if(bP.mozCancelFullScreen){bP.mozCancelFullScreen()}else{if(bP.msExitFullscreen){bP.msExitFullscreen()}}}}}},change:function aI(bT){var bR=this.options,bQ=this.pointers;var bU=bQ[Object.keys(bQ)[0]];var bP=bU.endX-bU.startX;var bV=bU.endY-bU.startY;switch(this.action){case bx:this.move(bP,bV);break;case y:this.zoom(a4(bQ),false,bT);break;case aj:this.action="switched";var bS=Math.abs(bP);if(bS>1&&bS>Math.abs(bV)){this.pointers={};if(bP>1){this.prev(bR.loop)}else{if(bP<-1){this.next(bR.loop)}}}break}ag(bQ,function(bW){bW.startX=bW.endX;bW.startY=bW.endY})},isSwitchable:function bv(){var bQ=this.imageData,bP=this.viewerData;return this.length>1&&bQ.left>=0&&bQ.top>=0&&bQ.width<=bP.width&&bQ.height<=bP.height}};var aP=an.Viewer;var S=function(){function bQ(bV){var bU=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};aw(this,bQ);if(!bV||bV.nodeType!==1){throw new Error("The first argument is required and must be an element.")}this.element=bV;this.options=W({},N,o(bU)&&bU);this.action=false;this.fading=false;this.fulled=false;this.hiding=false;this.imageClicked=false;this.imageData={};this.index=this.options.initialViewIndex;this.isImg=false;this.isShown=false;this.length=0;this.played=false;this.playing=false;this.pointers={};this.ready=false;this.showing=false;this.timeout=false;this.tooltipping=false;this.viewed=false;this.viewing=false;this.wheeling=false;this.zooming=false;this.init()}aZ(bQ,[{key:"init",value:function bS(){var bZ=this;var bX=this.element,b2=this.options;if(bX[G]){return}bX[G]=this;var bV=bX.tagName.toLowerCase()==="img";var b1=[];ag(bV?[bX]:bX.querySelectorAll("img"),function(b4){if(j(b2.filter)){if(b2.filter.call(bZ,b4)){b1.push(b4)}}else{b1.push(b4)}});this.isImg=bV;this.length=b1.length;this.images=b1;var b3=bX.ownerDocument;var bY=b3.body||b3.documentElement;this.body=bY;this.scrollbarWidth=window.innerWidth-b3.documentElement.clientWidth;this.initialBodyPaddingRight=window.getComputedStyle(bY).paddingRight;if(aJ(document.createElement(G).style.transition)){b2.transition=false}if(b2.inline){var b0=0;var bU=function bU(){b0+=1;if(b0===bZ.length){var b4;bZ.initializing=false;bZ.delaying={abort:function b5(){clearTimeout(b4)}};b4=setTimeout(function(){bZ.delaying=false;bZ.build()},0)}};this.initializing={abort:function bW(){ag(b1,function(b4){if(!b4.complete){f(b4,aC,bU)}})}};ag(b1,function(b4){if(b4.complete){bU()}else{bk(b4,aC,bU,{once:true})}})}else{bk(bX,s,this.onStart=function(b4){var b5=b4.target;if(b5.tagName.toLowerCase()==="img"&&(!j(b2.filter)||b2.filter.call(bZ,b5))){bZ.view(bZ.images.indexOf(b5))}})}}},{key:"build",value:function bR(){if(this.ready){return}var bZ=this.element,ca=this.options;var b8=bZ.parentNode;var b9=document.createElement("div");b9.innerHTML=ae;var b1=b9.querySelector(".".concat(G,"-container"));var b6=b1.querySelector(".".concat(G,"-title"));var b7=b1.querySelector(".".concat(G,"-toolbar"));var bW=b1.querySelector(".".concat(G,"-navbar"));var b0=b1.querySelector(".".concat(G,"-button"));var bX=b1.querySelector(".".concat(G,"-canvas"));this.parent=b8;this.viewer=b1;this.title=b6;this.toolbar=b7;this.navbar=bW;this.button=b0;this.canvas=bX;this.footer=b1.querySelector(".".concat(G,"-footer"));this.tooltipBox=b1.querySelector(".".concat(G,"-tooltip"));
this.player=b1.querySelector(".".concat(G,"-player"));this.list=b1.querySelector(".".concat(G,"-list"));q(b6,!ca.title?ac:R(Array.isArray(ca.title)?ca.title[0]:ca.title));q(bW,!ca.navbar?ac:R(ca.navbar));aS(b0,ac,!ca.button);if(ca.backdrop){q(b1,"".concat(G,"-backdrop"));if(!ca.inline&&ca.backdrop!=="static"){ak(bX,bg,"hide")}}if(bf(ca.className)&&ca.className){ca.className.split(B).forEach(function(cb){q(b1,cb)})}if(ca.toolbar){var b4=document.createElement("ul");var bV=o(ca.toolbar);var bY=n.slice(0,3);var b2=n.slice(7,9);var b5=n.slice(9);if(!bV){q(b7,R(ca.toolbar))}ag(bV?ca.toolbar:n,function(ci,ce){var cc=bV&&o(ci);var cd=bV?bs(ce):ci;var cb=cc&&!aJ(ci.show)?ci.show:ci;if(!cb||!ca.zoomable&&bY.indexOf(cd)!==-1||!ca.rotatable&&b2.indexOf(cd)!==-1||!ca.scalable&&b5.indexOf(cd)!==-1){return}var cf=cc&&!aJ(ci.size)?ci.size:ci;var ch=cc&&!aJ(ci.click)?ci.click:ci;var cg=document.createElement("li");cg.setAttribute("role","button");q(cg,"".concat(G,"-").concat(cd));if(!j(ch)){ak(cg,bg,cd)}if(V(cb)){q(cg,R(cb))}if(["small","large"].indexOf(cf)!==-1){q(cg,"".concat(G,"-").concat(cf))}else{if(cd==="play"){q(cg,"".concat(G,"-large"))}}if(j(ch)){bk(cg,s,ch)}b4.appendChild(cg)});b7.appendChild(b4)}else{q(b7,ac)}if(!ca.rotatable){var b3=b7.querySelectorAll('li[class*="rotate"]');q(b3,ab);ag(b3,function(cb){b7.appendChild(cb)})}if(ca.inline){q(b0,bu);M(b1,{zIndex:ca.zIndexInline});if(window.getComputedStyle(b8).position==="static"){M(b8,{position:"relative"})}b8.insertBefore(b1,bZ.nextSibling)}else{q(b0,bB);q(b1,bI);q(b1,c);q(b1,ac);M(b1,{zIndex:ca.zIndex});var bU=ca.container;if(bf(bU)){bU=bZ.ownerDocument.querySelector(bU)}if(!bU){bU=this.body}bU.appendChild(b1)}if(ca.inline){this.render();this.bind();this.isShown=true}this.ready=true;if(j(ca.ready)){bk(bZ,ad,ca.ready,{once:true})}if(aL(bZ,ad)===false){this.ready=false;return}if(this.ready&&ca.inline){this.view(this.index)}}}],[{key:"noConflict",value:function bP(){window.Viewer=aP;return bQ}},{key:"setDefaults",value:function bT(bU){W(N,o(bU)&&bU)}}]);return bQ}();W(S.prototype,Q,bF,aT,aq,ap);return S})));